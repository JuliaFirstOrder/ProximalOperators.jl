<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Prox and gradient · ProximalOperators.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ProximalOperators.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ProximalOperators.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../calculus/">Calculus rules</a></li><li class="is-active"><a class="tocitem" href>Prox and gradient</a><ul class="internal"><li><a class="tocitem" href="#Complex-and-matrix-variables"><span>Complex and matrix variables</span></a></li><li><a class="tocitem" href="#Multiple-variable-blocks"><span>Multiple variable blocks</span></a></li></ul></li><li><a class="tocitem" href="../demos/">Demos</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Prox and gradient</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Prox and gradient</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaFirstOrder/ProximalOperators.jl/blob/master/docs/src/operators.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Prox-and-gradient"><a class="docs-heading-anchor" href="#Prox-and-gradient">Prox and gradient</a><a id="Prox-and-gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Prox-and-gradient" title="Permalink"></a></h1><p>ProximalOperators relies on the first-order primitives defined in <a href="https://github.com/JuliaFirstOrder/ProximalCore.jl">ProximalCore</a>. The following methods allow to evaluate the proximal mapping (and gradient, when defined) of mathematical functions, which are constructed according to what described in <a href="../functions/#Functions">Functions</a> and <a href="../calculus/#Calculus-rules">Calculus rules</a>.</p><article class="docstring"><header><a class="docstring-binding" id="ProximalCore.prox" href="#ProximalCore.prox"><code>ProximalCore.prox</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">prox(f, x, gamma=1)</code></pre><p>Proximal mapping for <code>f</code>, evaluated at <code>x</code>, with stepsize <code>gamma</code>.</p><p>The proximal mapping is defined as</p><p class="math-container">\[\mathrm{prox}_{\gamma f}(x) = \arg\min_z \left\{ f(z) + \tfrac{1}{2\gamma}\|z-x\|^2 \right\}.\]</p><p>Returns a tuple <code>(y, fy)</code> consisting of</p><ul><li><code>y</code>: the output of the proximal mapping of <code>f</code> at <code>x</code> with stepsize <code>gamma</code></li><li><code>fy</code>: the value of <code>f</code> at <code>y</code></li></ul><p>See also: <a href="#ProximalCore.prox!"><code>prox!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ProximalCore.prox!" href="#ProximalCore.prox!"><code>ProximalCore.prox!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">prox!(y, f, x, gamma=1)</code></pre><p>In-place proximal mapping for <code>f</code>, evaluated at <code>x</code>, with stepsize <code>gamma</code>.</p><p>The proximal mapping is defined as</p><p class="math-container">\[\mathrm{prox}_{\gamma f}(x) = \arg\min_z \left\{ f(z) + \tfrac{1}{2\gamma}\|z-x\|^2 \right\}.\]</p><p>The result is written to the (pre-allocated) array <code>y</code>, which should have the same shape/size as <code>x</code>.</p><p>Returns the value of <code>f</code> at <code>y</code>.</p><p>See also: <a href="#ProximalCore.prox"><code>prox</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ProximalCore.gradient" href="#ProximalCore.gradient"><code>ProximalCore.gradient</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gradient(f, x)</code></pre><p>Gradient (and value) of <code>f</code> at <code>x</code>.</p><p>Return a tuple <code>(y, fx)</code> consisting of</p><ul><li><code>y</code>: the gradient of <code>f</code> at <code>x</code></li><li><code>fx</code>: the value of <code>f</code> at <code>x</code></li></ul><p>See also: <a href="#ProximalCore.gradient!"><code>gradient!</code></a>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="ProximalCore.gradient!" href="#ProximalCore.gradient!"><code>ProximalCore.gradient!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gradient!(y, f, x)</code></pre><p>In-place gradient (and value) of <code>f</code> at <code>x</code>.</p><p>The gradient is written to the (pre-allocated) array <code>y</code>, which should have the same shape/size as <code>x</code>.</p><p>Returns the value <code>f</code> at <code>x</code>.</p><p>See also: <a href="#ProximalCore.gradient"><code>gradient</code></a>.</p></div></section></article><h2 id="Complex-and-matrix-variables"><a class="docs-heading-anchor" href="#Complex-and-matrix-variables">Complex and matrix variables</a><a id="Complex-and-matrix-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-and-matrix-variables" title="Permalink"></a></h2><p>The proximal mapping is usually discussed in the case of functions over <span>$\mathbb{R}^n$</span>. However, by adapting the inner product <span>$\langle\cdot,\cdot\rangle$</span> and associated norm <span>$\|\cdot\|$</span> adopted in its definition, one can extend the concept to functions over more general spaces. When functions of unidimensional arrays (vectors) are concerned, the standard Euclidean product and norm are used in defining <a href="#ProximalCore.prox"><code>prox</code></a> (therefore <a href="#ProximalCore.prox!"><code>prox!</code></a>, but also <a href="#ProximalCore.gradient"><code>gradient</code></a> and <a href="#ProximalCore.gradient!"><code>gradient!</code></a>). This are the inner product and norm which are computed by <code>dot</code> and <code>norm</code> in Julia.</p><p>When bidimensional, tridimensional (matrices and tensors) and higher dimensional arrays are concerned, then the definitions of proximal mapping and gradient are naturally extended by considering the appropriate inner product. For <span>$k$</span>-dimensional arrays, of size <span>$n_1 \times n_2 \times \ldots \times n_k$</span>, we consider the inner product</p><p class="math-container">\[\langle A, B \rangle = \sum_{i_1,\ldots,i_k} A_{i_1,\ldots,i_k} \cdot B_{i_1,\ldots,i_k}\]</p><p>which reduces to the usual Euclidean product in case of unidimensional arrays, and to the <em>trace product</em> <span>$\langle A, B \rangle = \mathrm{tr}(A^\top B)$</span> in the case of matrices (bidimensional arrays). This inner product, and the associated norm, are again the ones computed by <code>dot</code> and <code>norm</code> in Julia.</p><h2 id="Multiple-variable-blocks"><a class="docs-heading-anchor" href="#Multiple-variable-blocks">Multiple variable blocks</a><a id="Multiple-variable-blocks-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-variable-blocks" title="Permalink"></a></h2><p>By combining functions together through <a href="../calculus/#ProximalOperators.SeparableSum"><code>SeparableSum</code></a>, the resulting function will have multiple inputs, <em>i.e.</em>, it will be defined over the <em>Cartesian product</em> of the domains of the individual functions. To represent elements (points) of such product space, here we use Julia&#39;s <code>Tuple</code> objects.</p><p><strong>Example.</strong> Suppose that the following function needs to be represented:</p><p class="math-container">\[f(x, Y) = \|x\|_1 + \|Y\|_*,\]</p><p>that is, the sum of the <span>$L_1$</span> norm of some vector <span>$x$</span> and the nuclear norm (the sum of the singular values) of some matrix <span>$Y$</span>. This is accomplished as follows:</p><pre><code class="language-example hljs">using ProximalOperators
f = SeparableSum(NormL1(), NuclearNorm());</code></pre><p>Now, function <code>f</code> is defined over <em>pairs</em> of appropriate <code>Array</code> objects. Likewise, the <a href="#ProximalCore.prox"><code>prox</code></a> method will take pairs of <code>Array</code>s as inputs, and return pairs of <code>Array</code>s as output:</p><pre><code class="language-example hljs">x = randn(10); # some random vector
Y = randn(20, 30); # some random matrix
f_xY = f((x, Y)); # evaluates f at (x, Y)
(u, V), f_uV = prox(f, (x, Y), 1.3); # computes prox at (x, Y)</code></pre><p>The same holds for the separable sum of more than two functions, in which case &quot;pairs&quot; are to be replaced with <code>Tuple</code>s of the appropriate length.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../calculus/">« Calculus rules</a><a class="docs-footer-nextpage" href="../demos/">Demos »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Monday 14 February 2022 21:50">Monday 14 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
