############
# dspev!
############

if isdefined(Prox, :dspev!)

println("testing dspev!")

a = [1.0,2.0,3.0,5.0,6.0,9.0]
W_ref = [40551787053094354e-32,0.6992647456322811,14.30073525436772]
Z_ref = [-0.9486832980505137	0.1778191059691133	-0.2614963968247846;
  23792816675194395e-32	-0.8269242138935414	-0.5623133863572412;
  0.3162277660168379	0.5334573179073406	-0.7844891904743534]

W, Z = Prox.dspev!('V','L',a)

@test all((W-W_ref)./(1+abs(W_ref)) .<= 1e-8)
@test all((Z-Z_ref)./(1+abs(Z_ref)) .<= 1e-8)

end
